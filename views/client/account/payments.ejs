<%- layout('layouts/boilerplate') %> 


<div class="content-space-t-2">
  <!-- Breadcrumb -->
  <div class="navbar-dark bg-dark" style="background-image: url(/public/assets/svg/components/wave-pattern-light.svg);">
    <div class="container content-space-1 content-space-b-lg-3">
      <div class="row align-items-center">
        <div class="col">
          <div class="d-lg-block">
            <h1 class="h2 text-white">Account</h1>
          </div>

          <!-- Breadcrumb -->
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb breadcrumb-light mb-0">
              <li class="breadcrumb-item"> 
              <%= user.addy.address1 %> #<%= user.mailbox %> <%= user.addy.city %>, <%= user.addy.state %>   
              </li>
              <!-- <li class="breadcrumb-item active">Mailbox #<b><%= user.mailbox %> </b></li> -->
            </ol>
          </nav>
          <!-- End Breadcrumb -->
        </div>
        <!-- End Col -->

        <div class="col-auto">


          <!-- Responsive Toggle Button -->
          <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarNav" aria-controls="sidebarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-default">
              <i class="bi-list"></i>
            </span>
            <span class="navbar-toggler-toggled">
              <i class="bi-x"></i>
            </span>
          </button>
          <!-- End Responsive Toggle Button -->
        </div>
        <!-- End Col -->
      </div>
      <!-- End Row -->
    </div>
  </div>
  <!-- End Breadcrumb -->

  <!-- Content Section -->
  <div class="container content-space-1 content-space-t-lg-0 content-space-b-lg-2 mt-lg-n10">
    <div class="row">
      <div class="col-lg-3">
        <!-- Navbar -->
        <div class="navbar-expand-lg navbar-light">
          <div id="sidebarNav" class="collapse navbar-collapse navbar-vertical">
            <!-- Card -->
            <div class="card flex-grow-1 mb-5">
              <div class="card-body">
                <!-- Avatar -->
                <div class="d-none d-lg-block text-center mb-5">
                  <h4 class="card-title mb-0"><%= user.firstName %> <%= user.lastName %> </h4>
                  <p class="card-text small"><%= user.email %> </p>
                </div>
                <!-- End Avatar -->

                <!-- Nav -->
                <span class="text-cap">Account</span>

                <!-- List -->
                <ul class="nav nav-sm nav-tabs nav-vertical mb-4">
                  <li class="nav-item">
                    <a class="nav-link " href="/client/account/personal">
                      <i class="bi-person-badge nav-icon"></i> Personal info
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/client/account/security">
                      <i class="bi-shield-shaded nav-icon"></i> Security
                    </a>
                  </li>
                  <!-- <li class="nav-item">
                    <a class="nav-link " href="/client/account/notifications">
                      <i class="bi-bell nav-icon"></i> Notifications
                    </a>
                  </li> -->

                </ul>
                <!-- End List -->


                <span class="text-cap">Billing</span>

                <!-- List -->
                <ul class="nav nav-sm nav-tabs nav-vertical">
                  <li class="nav-item">
                    <a class="nav-link active " href="/client/account/payments">
                      <i class="bi-credit-card nav-icon"></i> Payments
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link " href="/client/account/addresses">
                      <i class="bi-geo-alt nav-icon"></i> Addresses
                    </a>
                  </li>
                </ul>
                <!-- End List -->


              </div>
            </div>
            <!-- End Card -->
          </div>
        </div>
        <!-- End Navbar -->
      </div>
      <!-- End Col -->

      <div class="col-lg-9">
        <div class="d-grid gap-3 gap-lg-5">
          <!-- Card -->
          <div class="card">
            <!-- Header -->
            <div class="card-header d-flex justify-content-between align-items-center border-bottom">
              <h5 class="card-header-title">Overview</h5>
            </div>
            <!-- End Header -->

            <!-- Body -->
            <div class="card-body">
              <div class="row">
                <div class="col-md mb-4 mb-md-0">
                  <div class="mb-4">
                    <span class="card-subtitle">Your plan (billed monthly):</span>
                    <h5>Basic</h5>
                  </div>

                  <div>
                    <span class="card-subtitle">Total per month</span>
                    <h3 class="text-primary">$15 USD</h3>
                  </div>
                </div>
                <!-- End Col -->

                <div class="col-md-auto">
                  <div class="d-grid d-md-flex gap-3">
                    <a class="btn btn-white btn-sm" href="#">Cancel subscription</a>
                    <a class="btn btn-primary btn-sm btn-transition" href="./page-pricing.html">Update plan</a>
                  </div>
                </div>
                <!-- End Col -->
              </div>
              <!-- End Row -->
            </div>
            <!-- End Body -->

            <hr class="my-3">

            <!-- Body -->
            <div class="card-body">
              <div class="row align-items-center flex-grow-1 mb-2">
                <div class="col">
                  <h4 class="card-header-title">Monthly forward allowance</h4>
                </div>
                <!-- End Col -->

                <div class="col-auto">
                  <span class="text-dark fw-semi-bold">4</span> forwarded of 10
                </div>
                <!-- End Col -->
              </div>
              <!-- End Row -->

              <!-- Progress -->
              <div class="progress rounded-pill mb-3">
                <div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
              <!-- End Progress -->
            </div>
            <!-- End Body -->
          </div>
          <!-- End Card -->

          <!-- Card -->
          <div class="card">
            <div class="card-header border-bottom">
              <h5 class="card-header-title">Payment method</h5>
            </div>

            <!-- Body -->
            <div class="card-body">
              <div class="mb-4">
                <p>We currently support Visa, American Express, Mastercard, and Discover. Crypto payments coming soon.</p>
              </div>

              <!-- List Group -->
              <ul class="list-group mb-5">

                <% for (let p of user.payments) { %> 
                <!-- Item -->
                <li class="list-group-item">
                  <div class="mb-2">
                    <h5><%= p.firstName %> <%= p.lastName %> 
                      <% if (p.default) { %> 
                      <span class="badge bg-primary ms-1">Primary</span>
                      <% } %> 
                    </h5>
                  </div>

                  <!-- Media -->
                  <div class="d-flex">
                    <div class="flex-shrink-0">
                      <% if(p.cardType == 'Visa') { %> 
                      <img class="avatar avatar-sm" src="/public/assets/svg/brands/visa.svg" alt="Image Description">
                      <% } else if (p.cardType == 'MasterCard') { %> 
                      <img class="avatar avatar-sm" src="/public/assets/svg/brands/mastercard.svg" alt="Image Description">
                      <% } %> 
                    </div>

                    <div class="flex-grow-1 ms-3">
                      <div class="row">
                        <div class="col-sm mb-3 mb-sm-0">
                          <span class="d-block text-dark"><%= p.cardType %> <%= p.cardNumber.replace('XXXX','•••• ')%> </span>
                          <small class="d-block text-muted">Debit - Expires 12/69</small>
                        </div>
                        <!-- End Col -->

                        <div class="col-sm-auto">
                          <div class="d-flex gap-3">
                            <!-- <a class="btn btn-white btn-xs" href="javascript:;" data-bs-toggle="modal" data-bs-target="#accountEditCardModal">
                              <i class="bi-pencil-fill me-1"></i> Edit
                            </a> -->

                            <form action="/client/account/payments/<%=p.id%>?_method=DELETE" method="post">
                              <button type="submit" class="btn btn-white btn-xs">
                                <i class="bi-trash me-1"></i> Delete
                              </button>
                            </form>
                          </div>
                        </div>
                        <!-- End Col -->
                      </div>
                      <!-- End Row -->
                    </div>
                  </div>
                  <!-- End Media -->
                </li>
                <!-- End Item -->

                <% } %> 
              </ul>
              <!-- End List Group -->

              <!-- Card -->
              <a class="card card-dashed card-centered" href="javascript:;" data-bs-toggle="modal" data-bs-target="#accountAddCardModal">
                <div class="card-body card-dashed-body py-8">
                  <img class="avatar avatar-lg avatar-4x3 mb-2" src="/public/assets/svg/illustrations/oc-add-card.svg" alt="Image Description">
                  <span class="d-block"><i class="bi-plus"></i> Add a new card</span>
                </div>
              </a>
              <!-- End Card -->
            </div>
            <!-- End Body -->
          </div>
          <!-- End Card -->

          <!-- Card -->
          <div class="card">
            <!-- Header -->
            <div class="card-header">
              <h5 class="card-header-title">Payment history</h5>
            </div>
            <!-- End Header -->

            <!-- Table -->
            <div class="table-responsive">
              <table class="table table-borderless table-thead-bordered table-nowrap table-align-middle">
                <thead class="thead-light">
                  <tr>
                    <th>Reference</th>
                    <th>Status</th>
                    <th>Amount</th>
                    <th>Updated</th>
                    <th>Invoice</th>
                    <th></th>
                  </tr>
                </thead>

                <tbody>
                  <!-- <tr>
                    <td><a href="#">#3682303</a></td>
                    <td><span class="badge bg-soft-warning text-warning">Pending</span></td>
                    <td>$264</td>
                    <td>22/04/2020</td>
                    <td><a class="btn btn-white btn-xs" href="./page-invoice.html"><i class="bi-file-earmark-arrow-down-fill me-1"></i> PDF</a></td>
                    <td><a class="btn btn-white btn-xs" href="javascript:;" data-bs-toggle="modal" data-bs-target="#accountInvoiceReceiptModal"><i class="bi-eye-fill me-1"></i> Quick view</a></td>
                  </tr>

                  <tr>
                    <td><a href="#">#2333234</a></td>
                    <td><span class="badge bg-soft-success text-success">Successful</span></td>
                    <td>$264</td>
                    <td>22/04/2019</td>
                    <td><a class="btn btn-white btn-xs" href="./page-invoice.html"><i class="bi-file-earmark-arrow-down-fill me-1"></i> PDF</a></td>
                    <td><a class="btn btn-white btn-xs" href="javascript:;" data-bs-toggle="modal" data-bs-target="#accountInvoiceReceiptModal"><i class="bi-eye-fill me-1"></i> Quick view</a></td>
                  </tr>

                  <tr>
                    <td><a href="#">#9834283</a></td>
                    <td><span class="badge bg-soft-success text-success">Successful</span></td>
                    <td>$264</td>
                    <td>22/04/2018</td>
                    <td><a class="btn btn-white btn-xs" href="./page-invoice.html"><i class="bi-file-earmark-arrow-down-fill me-1"></i> PDF</a></td>
                    <td><a class="btn btn-white btn-xs" href="javascript:;" data-bs-toggle="modal" data-bs-target="#accountInvoiceReceiptModal"><i class="bi-eye-fill me-1"></i> Quick view</a></td>
                  </tr> -->
                </tbody>
              </table>
            </div>
            <!-- End Table -->
          </div>
          <!-- End Card -->
        </div>
      </div>
      <!-- End Col -->
    </div>
    <!-- End Row -->
  </div>
  <!-- End Content Section -->
</div>

<div class="modal fade" id="accountAddCardModal" tabindex="-1" aria-labelledby="accountAddCardModalLabel" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <!-- Header -->
      <div class="modal-header">
        <h4 class="modal-title" id="accountAddCardModalLabel">Add card</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <!-- End Header -->

      <!-- Body -->
      <div class="modal-body">
        <!-- Form -->
        <form action="/client/account/payments" method="post">
          <!-- Radio Button Group -->
          <div class="btn-group btn-group-segment d-flex mb-4" role="group" aria-label="Account add card radio button group">
            <input type="radio" class="btn-check" name="accountAddCardBtnRadio" id="accountAddCardBtnRadioOption1" autocomplete="off" checked="">
            <label class="btn btn-sm" for="accountAddCardBtnRadioOption1">Credit or Debit card</label>

            <input type="radio" class="btn-check" name="accountAddCardBtnRadio" id="accountAddCardBtnRadioOption2" autocomplete="off" disabled="">
            <label class="btn btn-sm" for="accountAddCardBtnRadioOption2">Crypto <span class="badge bg-soft-primary text-primary">Coming soon</span></label>
          </div>
          <!-- End Radio Button Group -->


          <!-- Form -->
          <div class="mb-4">
            <label for="cardNumberLabel" class="form-label">Card number</label>
            <input type="text" class="js-input-mask form-control" name="cardNumber" id="cardNumberLabel" placeholder="xxxx xxxx xxxx xxxx" aria-label="xxxx xxxx xxxx xxxx" data-hs-mask-options="{
                    &quot;mask&quot;: &quot;0000 0000 0000 0000&quot;
                  }">
          </div>
          <!-- End Form -->

          <div class="row">
            <div class="col-sm-6">
              <!-- Form -->
              <div class="mb-4">
                <label for="expirationDateLabel" class="form-label">Expiration date</label>
                <input type="text" class="js-input-mask form-control" name="cardExp" id="expirationDateLabel" placeholder="MMYY" data-hs-mask-options="{
                        &quot;mask&quot;: &quot;00/0000&quot;
                      }">
              </div>
              <!-- End Form -->
            </div>

            <div class="col-sm-6">
              <!-- Form -->
              <div class="mb-4">
                <label for="securityCodeLabel" class="form-label">CVV Code <i class="bi-question-circle text-body ml-1" data-toggle="tooltip" data-placement="top" title="A 3 - digit number, typically printed on the back of a card."></i></label>
                <input type="text" class="js-input-mask form-control" name="cvv" id="securityCodeLabel" placeholder="xxx" aria-label="xxx" data-hs-mask-options="{
                        &quot;mask&quot;: &quot;000&quot;
                      }">
              </div>
              <!-- End Form -->
            </div>
          </div>
          <!-- End Row -->



          <h4 class="my-5">Billing address</h4>


          <div class="row">

            <div class="col-sm-6">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="billingFirstName">First name</label>
                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-person-fill"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" id="billingFirstName" name="billingFirstName" placeholder="Virgil" aria-label="First name" required="">

                    </div>

                </div>
                <!-- End Form -->
            </div>
            <div class="col-sm-6">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="billingLastName">Last name</label>
                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-person-fill"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" id="billingLastName" name="billingLastName" placeholder="Abloh" aria-label="Last name" required="">
                    </div>
                </div>
                <!-- End Form -->
            </div>
            <!-- End Col -->


        </div>


        <div class="row">
            <div class="col-sm-6">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="street1">Street line 1</label>

                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-geo-alt-fill"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" id="street1" name="street1"
                            placeholder="123 Main St" aria-label="Address">
                    </div>
                </div>
                <!-- End Form -->
            </div>
            <!-- End Col -->

            <div class="col-sm-6">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="street2">Street line 2</label>

                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-geo-alt-fill"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" id="street2" name="street2"
                            placeholder="Apt 5" aria-label="Address">
                    </div>
                </div>
                <!-- End Form -->
            </div>
            <!-- End Col -->
        </div>
        <!-- End Row -->

        <div class="row">
            <div class="col-sm-4">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="city">City</label>
                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-building"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" id="city" name="city"
                            placeholder="LA" aria-label="City/Province">
                    </div>
                </div>
                <!-- End Form -->
            </div>

            <div class="col-sm-4">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="state">State</label>
                    <div class="tom-select-custom">
                        <select class="js-select form-select form-select-lg" id="state" name="state" autocomplete="off"
                            data-hs-tom-select-options='{
                "placeholder": "Select a person...",
                "hideSearch": true
              }'>
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option selected value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="DC">District Of Columbia</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD">Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>
                    </div>
                </div>
                <!-- End Form -->
            </div>

            <div class="col-sm-4">
                <!-- Form -->
                <div class="mb-4">
                    <label class="form-label" for="zip">Postal code</label>

                    <div class="input-group input-group-merge">
                        <span class="input-group-prepend input-group-text">
                            <i class="bi-envelope-open-fill"></i>
                        </span>
                        <input type="text" class="form-control form-control-lg" name="zip" id="zip"
                            placeholder="10001" aria-label="Postal code">
                    </div>
                </div>
                <!-- End Form -->
            </div>
            <!-- End Col -->
        </div>

                  <!-- Custom Checkbox -->
                  <div class="form-check mb-4">
                    <input type="checkbox" class="form-check-input" id="makePrimaryCheckbox1">
                    <label class="form-check-label" for="makePrimaryCheckbox1">Make this primary card</label>
                  </div>
                  <!-- End Custom Checkbox -->

          <div class="d-flex justify-content-end gap-3">
            <button type="button" class="btn btn-white" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
        <!-- End Form -->
      </div>
      <!-- End Body -->
    </div>
  </div>
</div>
